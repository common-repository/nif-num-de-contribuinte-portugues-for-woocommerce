(()=>{var e={967:(e,t)=>{var o;!function(){"use strict";var n={}.hasOwnProperty;function a(){for(var e="",t=0;t<arguments.length;t++){var o=arguments[t];o&&(e=c(e,r(o)))}return e}function r(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return a.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var o in e)n.call(e,o)&&e[o]&&(t=c(t,o));return t}function c(e,t){return t?e?e+" "+t:e+t:e}e.exports?(a.default=a,e.exports=a):void 0===(o=function(){return a}.apply(t,[]))||(e.exports=o)}()}},t={};function o(n){var a=t[n];if(void 0!==a)return a.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,o),r.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.wc.blocksCheckout,t=window.React;var n=o(967),a=o.n(n);const r=window.wp.i18n,c=window.wp.element,s=window.wp.data,i=window.wc.wcBlocksData,l=window.wc.wcSettings,{defaultLabel:u,defaultIsRequired:d,defaultValidate:p,defaultMaxLength:m,defaultShowAllCountries:f,defaultInvalidMessage:b}=(0,l.getSetting)("ptwoo_nif_data",""),w={lock:{type:"object",default:{move:!1,remove:!0}},className:{type:"string",default:""},stepTitle:{type:"string",default:(0,r.__)("Fiscal information","nif-num-de-contribuinte-portugues-for-woocommerce")},stepDescription:{type:"string",default:""},showStepNumber:{type:"boolean",default:!0},label:{type:"string",default:u},isRequired:{type:"boolean",default:d},validate:{type:"boolean",default:p},maxLength:{type:"integer",default:m},showAllCountries:{type:"boolean",default:f},invalidMessage:{type:"boolean",default:b}},g=({title:e,stepHeadingContent:o})=>(0,t.createElement)("div",{className:"wc-block-components-checkout-step__heading"},(0,t.createElement)("h2",{"aria-hidden":"true",className:"wc-block-components-checkout-step__title wc-block-components-title"},e),!!o&&(0,t.createElement)("span",{className:"wc-block-components-checkout-step__heading-content"},o)),h=({title:e="",description:o="",showStepNumber:n=!0,className:r="",children:c,stepHeadingContent:s=(()=>{})})=>{const i=e?"fieldset":"div";return(0,t.createElement)(i,{className:a()(r,"wc-block-components-checkout-step",{"wc-block-components-checkout-step--with-step-number":n})},e&&(0,t.createElement)("legend",{className:"screen-reader-text"},e),e&&(0,t.createElement)(g,{title:e,stepHeadingContent:s()}),(0,t.createElement)("div",{className:"wc-block-components-checkout-step__container"},o&&(0,t.createElement)("p",{className:"wc-block-components-checkout-step__description"},o),(0,t.createElement)("div",{className:"wc-block-components-checkout-step__content"},c)))},v="ptwoo-nif",k="billing-nif-invalid",y=(_=w,e=>o=>{const n=((e,t)=>{const o=[];return Object.keys(e).forEach((n=>{if(void 0!==t[n])switch(e[n].type){case"boolean":o[n]="false"!==t[n]&&!1!==t[n];break;case"number":o[n]=parseInt(t[n],10);break;case"array":case"object":o[n]=JSON.parse(t[n]);break;default:o[n]=t[n]}else o[n]=e[n].default})),o})(_,o);return(0,t.createElement)(e,{...o,...n})})((o=>{const{stepTitle:n,stepDescription:l,showStepNumber:u,label:d,isRequired:p,validate:m,maxLength:f,showAllCountries:b,invalidMessage:w,className:g,validation:{setValidationErrors:y,getValidationError:_,clearValidationError:N}}=o,{extensions:E,billingCountry:C}=(0,s.useSelect)((e=>{const t=e(i.CART_STORE_KEY),{extensions:o,billingAddress:n}=t.getCartData(),{country:a}=n;return{billingCountry:a,extensions:o}})),{__internalIncrementCalculating:S,__internalDecrementCalculating:x}=(0,s.useDispatch)(i.CHECKOUT_STORE_KEY),[O,L]=(0,c.useState)(!1),[T,D]=(0,c.useState)(E[v]?.billingNif),[I,R]=(0,c.useState)(E[v]?.billingNif),j=b||!b&&"PT"===C,A=_(k),M=!1===A?.hidden&&""!==A?.message,P=A?.message;(0,c.useEffect)((()=>(E[v]?.isValid?N(k):y({[k]:{message:w,hidden:!1}}),()=>{N(k)})),[E[v],T]),(0,c.useEffect)((()=>{T!==I&&(S(),(0,e.extensionCartUpdate)({namespace:v,data:{billingNif:T,isRequired:p,validate:m},cartPropsToReceive:["extensions"]}).then((()=>{x(),R(T)})))}),[e.extensionCartUpdate,T,p,m,S,x,I,R]);const q=(0,c.useCallback)((e=>{N(k),0===e.length&&p&&y({[k]:{message:w,hidden:!1}}),D(e)}),[D,N,y]);return(0,t.createElement)("div",{className:g},j&&(0,t.createElement)(h,{title:n,description:l,showStepNumber:u},(0,t.createElement)("div",{className:a()("wc-block-components-text-input",{"is-active":O||T},{"has-error":M})},(0,t.createElement)(e.ValidatedTextInput,{type:"text",id:"billing_nif","aria-label":d,maxLength:f,autoComplete:"on",required:p,onChange:q,onFocus:()=>L(!0),onBlur:()=>L(!1),"aria-invalid":!0===M,value:T||""}),(0,t.createElement)("label",{htmlFor:"billing_nif"},(0,r.sprintf)("%s%s",d,!0===p?"":` ${(0,r.__)("(optional)","nif-num-de-contribuinte-portugues-for-woocommerce")}`)),M&&(0,t.createElement)("div",{className:"wc-block-components-validation-error",role:"alert"},(0,t.createElement)("p",null,P)))))}));var _;const N=JSON.parse('{"apiVersion":2,"name":"woocommerce/ptwoo-nif","version":"0.2.0","title":"NIF PortuguÃªs","category":"woocommerce","description":"","supports":{"html":false,"align":false,"multiple":false,"reusable":false},"parent":["woocommerce/checkout-fields-block"],"attributes":{"lock":{"type":"object","default":{"remove":true,"move":false}}},"textdomain":"nif-num-de-contribuinte-portugues-for-woocommerce"}');(0,e.registerCheckoutBlock)({metadata:N,component:y}),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector(".wp-block-woocommerce-checkout");e&&new MutationObserver(((e,t)=>{for(const o of e)if("childList"===o.type&&o.addedNodes.length>0){const e=Array.from(o.addedNodes);let n=e.find((e=>e.classList&&e.classList.contains("wp-block-woocommerce-checkout-shipping-methods-block")));if(n||(n=e.find((e=>e.classList&&e.classList.contains("wp-block-woocommerce-checkout-payment-block")))),n){t.disconnect();const e=document.querySelector(".wp-block-woocommerce-ptwoo-nif");e&&n.compareDocumentPosition(e)===Node.DOCUMENT_POSITION_FOLLOWING&&n.parentNode.insertBefore(e,n)}}})).observe(e,{childList:!0,subtree:!0})}))})()})();